apiVersion: v1
kind: Secret
metadata:
  name: argocd-secret
  namespace: argocd
  labels:
    app.kubernetes.io/name: argocd-secret
    app.kubernetes.io/part-of: argocd
type: Opaque
data:
  # GitHub OAuth client secret (base64 encoded)
  # This is handled by Dex configuration in argocd-cm ConfigMap
  # No additional secrets needed for GitHub OAuth via Dex
  
  # Admin password (if you want to keep local admin access)
  {{- $adminPassword := .Values.admin.password | default (randAlphaNum 64) }}
  admin.password: {{ $adminPassword | b64enc }}
  admin.passwordMtime: {{ now | date "2006-01-02T15:04:05Z" | b64enc }}
  
  # Additional user passwords
  {{- if .Values.users }}
  {{- range .Values.users }}
  {{- if or (contains "login" .capabilities) (and (contains "apiKey" .capabilities) .password) }}
  {{- $password := .password | default (randAlphaNum 64) }}
  {{ .name }}.password: {{ $password | b64enc }}
  {{ .name }}.passwordMtime: {{ now | date "2006-01-02T15:04:05Z" | b64enc }}
  {{- end }}
  {{- end }}
  {{- end }}